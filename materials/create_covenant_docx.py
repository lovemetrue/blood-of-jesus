#!/usr/bin/env python3
"""
Создаёт три документа Word (.docx) в папке materials/Завет:
- Спасения.docx
- Посвящения.docx
- Даяния.docx
Требуется: pip install python-docx
"""
import os

try:
    from docx import Document
    from docx.shared import Pt
    from docx.enum.text import WD_ALIGN_PARAGRAPH
except ImportError:
    print("Установите python-docx: pip install python-docx")
    raise

OUT_DIR = os.path.join(os.path.dirname(__file__), "Завет")
os.makedirs(OUT_DIR, exist_ok=True)


def set_heading(doc, text, level=1):
    p = doc.add_heading(text, level=level)
    return p


def add_para(doc, text, bold=False):
    p = doc.add_paragraph()
    run = p.add_run(text)
    if bold:
        run.bold = True
    return p


def doc_salvation():
    """Завет спасения — наставление по заключению завета с Богом."""
    doc = Document()
    set_heading(doc, "Завет спасения", 0)
    add_para(doc, "Наставление по заключению завета с Богом")
    doc.add_paragraph()

    add_para(doc, "Бог — Бог заветов. Вся Библия говорит о Нём как о Том, Кто заключает заветы с людьми и хранит их. Он не просто даёт обетования — Он вступает в отношения завета со Своими детьми и очень ценит эти отношения.")
    doc.add_paragraph()

    set_heading(doc, "Почему завет спасения важен", level=2)
    add_para(doc, "Завет спасения — это не только «принять Иисуса в сердце». Это осознанное вступление в отношения завета с Живым Богом: Он становится вашим Богом, вы — Его народом. В завете есть две стороны: Бог обязуется быть нашим Спасителем, Хранителем и Отцом; мы откликаемся верой, покаянием и посвящением Ему жизни.")
    add_para(doc, "Иеремия 31:33 говорит о новом завете: «Вложу закон Мой во внутренность их и на сердцах их напишу его, и буду им Богом, а они будут Моим народом». Это и есть суть завета спасения: личные, вечные отношения с Богом.")
    doc.add_paragraph()

    set_heading(doc, "Как заключить завет спасения", level=2)
    add_para(doc, "1. Признайте свою нужду в Спасителе и покайтесь в грехах.")
    add_para(doc, "2. Уверуйте в Иисуса Христа: что Он умер за ваши грехи и воскрес, и что только через Него есть прощение и жизнь вечная.")
    add_para(doc, "3. Откройте сердце Господу и примите Его как Господа и Спасителя — тем самым вы вступаете в завет с Ним.")
    add_para(doc, "4. Провозгласите это вслух в молитве: попросите Бога быть вашим Богом и заявите о своём желании быть Его чадом по завету.")
    doc.add_paragraph()

    add_para(doc, "Бог любит отношения завета. Заключив с Ним завет спасения, вы входите в ту самую близость, которую Он желает иметь с каждым из Своих детей.")
    doc.save(os.path.join(OUT_DIR, "Спасения.docx"))
    print("Создан: Завет/Спасения.docx")


def doc_dedication():
    """Завет посвящения — наставление по заключению завета посвящения с Богом."""
    doc = Document()
    set_heading(doc, "Завет посвящения", 0)
    add_para(doc, "Наставление по заключению завета посвящения с Богом")
    doc.add_paragraph()

    add_para(doc, "Бог — Бог заветов. Он не только спасает нас по завету благодати, но и призывает к завету посвящения: отдать Ему всю жизнь, сердце и волю. Он очень любит отношения завета со Своими детьми и ждёт от нас ответа — осознанного посвящения.")
    doc.add_paragraph()

    set_heading(doc, "Что такое завет посвящения", level=2)
    add_para(doc, "Посвящение — это завет, в котором вы добровольно отдаёте себя Богу: «Господи, я больше не свой — я Твой». Это не «добавка» к спасению, а естественный отклик на милость Бога: «Итак умоляю вас, братия, милосердием Божиим, представьте тела ваши в жертву живую, святую, благоугодную Богу» (Римлянам 12:1).")
    doc.add_paragraph()

    set_heading(doc, "Как заключить завет посвящения", level=2)
    add_para(doc, "1. Осознайте, что вы уже принадлежите Богу по завету спасения, и решите жить именно так — как Его.")
    add_para(doc, "2. В молитве перед Богом откажитесь от права «распоряжаться собой» и передайте Ему свою жизнь, планы, семью, время и ресурсы.")
    add_para(doc, "3. Попросите Святого Духа освящать вас и вести по путям святости и послушания Слову.")
    add_para(doc, "4. Закрепите это молитвой завета: вслух объявите Богу о своём посвящении и попросите Его принять его и удержать вас в нём.")
    doc.add_paragraph()

    add_para(doc, "Бог — Бог заветов и очень любит отношения завета со Своими детьми. Завет посвящения углубляет ваши отношения с Ним и открывает путь к благословенной жизни в послушании и святости.")
    doc.save(os.path.join(OUT_DIR, "Посвящения.docx"))
    print("Создан: Завет/Посвящения.docx")


def doc_giving():
    """Завет даяния — наставление на основе Малахии 3:7–12."""
    doc = Document()
    set_heading(doc, "Завет даяния", 0)
    add_para(doc, "Наставление по заключению завета даяния с Богом (основано на Книге Малахии, 3 глава)")
    doc.add_paragraph()

    add_para(doc, "Бог — Бог заветов. Он устанавливает не только завет спасения и посвящения, но и призывает Своих детей к завету даяния: к честному, радостному приношению десятины и приношений. Он очень любит отношения завета со Своими детьми и желает, чтобы мы не «обкрадывали» Его, а доверяли Ему своим имением.")
    doc.add_paragraph()

    set_heading(doc, "Слово Господа (Малахия 3:7–12)", level=2)
    add_para(doc, "Со дней отцов ваших вы отступили от уставов Моих и не соблюдаете их; обратитесь ко Мне, и Я обращусь к вам, говорит Господь Саваоф. Вы скажете: «как нам обратиться?»")
    add_para(doc, "Можно ли человеку обкрадывать Бога? А вы обкрадываете Меня. Скажете: «чем обкрадываем мы Тебя?» Десятиною и приношениями.")
    add_para(doc, "Проклятием вы прокляты, потому что вы — весь народ — обкрадываете Меня.")
    add_para(doc, "Принесите все десятины в дом хранилища, чтобы в доме Моём была пища, и хотя в этом испытайте Меня, говорит Господь Саваоф: не открою ли Я для вас отверстий небесных и не изолью ли на вас благословения до избытка?")
    add_para(doc, "Я для вас запрещу пожирающим истреблять у вас плоды земные, и виноградная лоза на поле у вас не лишится плодов своих, говорит Господь Саваоф.")
    add_para(doc, "И блаженными называть будут вас все народы, потому что вы будете землёю вожделенною, говорит Господь Саваоф.")
    doc.add_paragraph()

    set_heading(doc, "Важность завета даяния", level=2)
    add_para(doc, "Господь ясно говорит: удержание десятины и приношений Он рассматривает как «обкрадывание» Бога. Напротив, принесение всей десятины в дом хранилища (дом Божий) — это шаг завета: мы доверяем Ему свои ресурсы, а Он обязуется открыть «отверстия небесные» и излить благословение до избытка, защитить плоды и сделать нас «землёю вожделенною».")
    doc.add_paragraph()

    set_heading(doc, "Как заключить завет даяния", level=2)
    add_para(doc, "1. Обратитесь к Господу и покайтесь в том, что десятины и приношения не отдавались или отдавались не полностью.")
    add_para(doc, "2. Решите в сердце отдавать десятину (десятую часть дохода) и приношения в дом Господень — туда, где вы духовно питаетесь и служите.")
    add_para(doc, "3. В молитве заключите с Богом завет даяния: объявите Ему о своём решении и попросите силы и радости исполнять его.")
    add_para(doc, "4. «Испытайте» Господа в этом: начните приносить десятину и приношения и доверьте Ему результат — Он обещает открыть небеса и благословить.")
    doc.add_paragraph()

    add_para(doc, "Бог — Бог заветов и очень любит отношения завета со Своими детьми. Завет даяния — не «налог», а акт доверия и послушания, на который Он отвечает щедрым благословением.")
    doc.save(os.path.join(OUT_DIR, "Даяния.docx"))
    print("Создан: Завет/Даяния.docx")


if __name__ == "__main__":
    doc_salvation()
    doc_dedication()
    doc_giving()
    print("Готово. Файлы в папке:", OUT_DIR)
